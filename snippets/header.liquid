{% comment %} @todo: Convert to header-group json {% endcomment %}
{% if settings.show_promo_bar %}
    {% render 'promo-bar' %}
{% endif %}

<div class="px-6 md:px-8 bg-gray-900">
    <div class="container flex items-center text-white relative mx-auto">
        <nav
                :class="$store.global.isMobileMenuVisible ? 'open' : 'closed'"
                aria-label="Mobile Navigation Overlay"
                class="block md:hidden"
                id="mobile-nav"
                role="navigation"
                x-cloak
                x-data>
            <button
                    id="mobile-nav-trigger"
                    type="button"
                    @click="$store.global.toggleMobileMenu()"
                    :aria-expanded="$store.global.isMobileMenuVisible"
                    aria-label="Mobile Navigation Button"
                    aria-controls="mobile-menu-list"
                    class="bg-transparent border-0 p-2 text-white fill-white focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 [&>svg]:w-[26px] [&>svg]:h-auto"
                    x-data>
                <span class="sr-only">Menu</span>
                <span aria-hidden="true" x-show="!$store.global.isMobileMenuVisible">
          {% render 'icon-hamburger' %}
        </span>
                <span aria-hidden="true" x-show="$store.global.isMobileMenuVisible">
          {% render 'icon-close-x' %}
        </span>
            </button>
            {% render 'mobile-menu' %}
        </nav>

        <a href="{{ routes.root_url }}" class="text-white no-underline text-2xl md:text-3xl uppercase ml-4 md:ml-0">
            {% if settings.logo %}
                {{ settings.logo | image_url: width: 200 | image_tag:
                    loading: "lazy",
                    class: "h-[80px] w-auto mr-4" }}
            {% else %}
                <img
                        src="{{ 'logo.svg' | asset_url }}"
                        alt="{{ shop.name }}"
                        loading="lazy"
                        class="h-[80px] w-auto mr-4 py-4"
                >
            {% endif %}
        </a>

        <div class="hidden md:block">
            {% render 'header-menu' %}
        </div>

        <div class="flex items-center space-x-3 self-center ml-auto">

            {% if settings.enable_modal %}
                <button
                        type="button"
                        class="text-white fill-white p-2 [&>svg]:h-[28px] focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 hidden md:block"
                        @click="$store.global.openModal()"
                        aria-label="Open Modal">
                    {% render 'icon-bubble-bottom' %}
                </button>
            {% endif %}

            {% if settings.enable_predictive_search %}
                <button
                        type="button"
                        class="text-white fill-white p-2 [&>svg]:h-[28px] hidden md:block focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900"
                        @click="$store.global.isPredictiveSearchVisible = true"
                        :aria-expanded="$store.global.isPredictiveSearchVisible ? 'true' : 'false'"
                        aria-label="Search"
                        aria-controls="predictive-search">
                    {% render 'icon-search' %}
                </button>
            {% else %}
                <a href="{{ routes.search_url }}" class="text-white fill-white p-2 [&>svg]:h-[28px] focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 hidden md:block" aria-label="Search">
                    {% render 'icon-search' %}
                </a>
            {% endif %}

            {% if shop.customer_accounts_enabled %}
                <a href="{{ routes.account_url }}" class="text-white fill-white p-2 [&>svg]:h-[28px] focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 hidden md:block" aria-label="Account">
                    {% render 'icon-user' %}
                </a>
            {% endif %}


            <button type="button"
               @click="$store.global.isMinicartVisible = true"
               class="relative text-white fill-white p-2 [&>svg]:h-[28px] focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900"
               aria-label="Shopping cart, {{ cart.item_count }} {% if cart.item_count == 1 %}item{% else %}items{% endif %}">
                {% render 'icon-cart' %}
                <span class="flex justify-center items-center bg-blue-500 text-white text-xs size-5 rounded-full absolute bottom-[58%] left-1/2" aria-hidden="true">
                    <span data-ajax-cart-bind="item_count" class="p-1 leading-4 text-center">
                        {{- cart.item_count -}}
                    </span>
                </span>
            </button>
        </div>

        {% comment %}
          // Output customer login links

          <ul>
          {% if shop.customer_accounts_enabled %}
          {% if customer %}
          <a href="{{ routes.account_url }}">
          {{ 'action.account' | t }}
          </a>
          {{ 'action.log_out' | t | customer_logout_link }}
          {% else %}
          {{ 'action.log_in' | t | customer_login_link }}
          {{ 'action.register' | t | customer_register_link }}
          {% endif %}
          {% endif %}
          </ul>
        {% endcomment %}
    </div>
</div>
