{%- comment -%}
  Article Comments Section

  Params:
  - article: required - Article object
{%- endcomment -%}

<div class="article-comments space-y-8">
  {%- if article.comments_count > 0 -%}
    <div class="space-y-6">
      {%- paginate article.comments by 50 -%}
        {%- for comment in article.comments -%}
          <div class="comment p-6 bg-gray-50 border border-gray-200" id="comment-{{ comment.id }}">
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0">
                <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center">
                  <span class="text-lg font-bold text-gray-600">
                    {{ comment.author | slice: 0 | upcase }}
                  </span>
                </div>
              </div>

              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-2">
                  <p class="font-semibold text-gray-900">{{ comment.author }}</p>
                  <span class="text-gray-300" aria-hidden="true">â€¢</span>
                  <time class="text-sm text-gray-500" datetime="{{ comment.created_at | date: '%Y-%m-%d' }}">
                    {{ comment.created_at | date: '%B %d, %Y' }}
                  </time>
                </div>

                <div class="prose prose-sm max-w-none text-gray-700">
                  {{ comment.content }}
                </div>
              </div>
            </div>
          </div>
        {%- endfor -%}

        {%- if paginate.pages > 1 -%}
          <div class="mt-8">
            {% render 'pagination-navigation', paginate: paginate %}
          </div>
        {%- endif -%}
      {%- endpaginate -%}
    </div>
  {%- endif -%}

  {%- # Comment Form -%}
  {%- if blog.moderated? -%}
    <p class="text-sm text-gray-600 mb-4">
      Please note, comments need to be approved before they are published.
    </p>
  {%- endif -%}

  {%- form 'new_comment', article -%}
    <div class="space-y-4">
      <h3 class="text-xl font-semibold text-gray-900">Leave a comment</h3>

      {%- if form.posted_successfully? -%}
        <div class="p-4 bg-green-50 border border-green-200 text-green-800" role="alert">
          {%- if blog.moderated? -%}
            Your comment was posted successfully. It will be published after approval.
          {%- else -%}
            Your comment was posted successfully! Thank you!
          {%- endif -%}
        </div>
      {%- endif -%}

      {%- if form.errors -%}
        <div class="p-4 bg-red-50 border border-red-200 text-red-800" role="alert">
          <p class="font-semibold mb-2">Oops! Something went wrong:</p>
          <ul class="list-disc list-inside">
            {%- for field in form.errors -%}
              <li>{{ form.errors.messages[field] }}</li>
            {%- endfor -%}
          </ul>
        </div>
      {%- endif -%}

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="space-y-1">
          <label for="comment-author" class="block text-sm font-medium text-gray-900">
            Name <span class="text-red-600">*</span>
          </label>
          <input
            type="text"
            id="comment-author"
            name="comment[author]"
            value="{{ form.author }}"
            required
            class="w-full border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent"
          >
        </div>

        <div class="space-y-1">
          <label for="comment-email" class="block text-sm font-medium text-gray-900">
            Email <span class="text-red-600">*</span>
          </label>
          <input
            type="email"
            id="comment-email"
            name="comment[email]"
            value="{{ form.email }}"
            required
            class="w-full border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent"
          >
        </div>
      </div>

      <div class="space-y-1">
        <label for="comment-body" class="block text-sm font-medium text-gray-900">
          Comment <span class="text-red-600">*</span>
        </label>
        <textarea
          id="comment-body"
          name="comment[body]"
          rows="6"
          required
          class="w-full border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent"
        >{{ form.body }}</textarea>
      </div>

      <div>
        {% render 'btn',
          text: 'Post Comment',
          type: 'primary'
        %}
      </div>
    </div>
  {%- endform -%}
</div>
